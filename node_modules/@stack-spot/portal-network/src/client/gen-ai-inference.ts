
import { HttpError } from '@oazapfts/runtime'
import { getApiAddresses } from '../api-addresses'
import { addSelfHostedModelV1LlmModelsPost, agentChatV1AgentAgentIdChatPost, defaults, deleteModelResourcesV1LlmResourcesResourceIdDelete, deleteV1LlmModelsModelIdDelete, getModelV1LlmModelsModelIdGet, listLlmProvidersV1LlmProvidersGet, listModelsV1LlmModelsGet, saveOrUpdateModelResourcesV1LlmModelsModelIdResourcesPut, toggleModelStatusV1LlmModelsModelIdPatch, updateV1LlmModelsModelIdPut } from '../api/genAiInference'
import { DefaultAPIError } from '../error/DefaultAPIError'
import { inferenceDictionary } from '../error/dictionary/ai-inference'
import { StackspotAPIError } from '../error/StackspotAPIError'
import { ReactQueryNetworkClient } from '../network/ReactQueryNetworkClient'
import { removeAuthorizationParam } from '../utils/remove-authorization-param'

class GenAiInference extends ReactQueryNetworkClient {
  constructor() {
    super(getApiAddresses().genAiInference.url, defaults)
  }

  protected buildStackSpotError(error: HttpError): StackspotAPIError {
    return new DefaultAPIError(error.data, error.status, inferenceDictionary, error.headers)
  }

  /**
   * List all models.
   */
  listModels = this.query(removeAuthorizationParam(listModelsV1LlmModelsGet))
  /**
   * List llm providers.
   */
  listProviders = this.query(removeAuthorizationParam(listLlmProvidersV1LlmProvidersGet))
  /**
   * Creates LLM self hosted model
   */
  createModel = this.mutation(removeAuthorizationParam(addSelfHostedModelV1LlmModelsPost))
  /**
   * Deletes a LLM self hosted model
   */
  deleteModel = this.mutation(removeAuthorizationParam(deleteV1LlmModelsModelIdDelete))
  /**
   * Gets model by ID.
   */
  getModel = this.query(removeAuthorizationParam(getModelV1LlmModelsModelIdGet))

  /**
   * Updates model by ID.
   */
  updateModel = this.mutation(removeAuthorizationParam(updateV1LlmModelsModelIdPut))
  /**
   * Toggle Model Status
   */
  toggleModelActive = this.mutation(removeAuthorizationParam(toggleModelStatusV1LlmModelsModelIdPatch))
  /**
   * Updates resources for a specific model ID.
   */
  updateModelResource = this.mutation(removeAuthorizationParam(saveOrUpdateModelResourcesV1LlmModelsModelIdResourcesPut))

  /**
   * Deletes a specific model resource by resource ID.
   */
  deleteModelResource = this.mutation(removeAuthorizationParam(deleteModelResourcesV1LlmResourcesResourceIdDelete))

  /**
   * Interaction with a specific AI agent
   */
  sendAgentMessage = this.mutation(removeAuthorizationParam(agentChatV1AgentAgentIdChatPost))
}

export const genAiInferenceClient = new GenAiInference()
