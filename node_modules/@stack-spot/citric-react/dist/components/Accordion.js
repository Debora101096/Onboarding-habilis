import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { listToClass } from '@stack-spot/portal-theme';
import { useTranslate } from '@stack-spot/portal-translate';
import { useEffect, useMemo, useState } from 'react';
import { applyCSSVariable } from '../utils/css.js';
import { withRef } from '../utils/react.js';
import { CitricComponent } from './CitricComponent.js';
/**
 * Creates an accordion, showing/hiding the children according to the state of the expand/collapse checkbox.
 *
 * The accordion must define a max height, which is 300 by default (measured in pixels). Whenever the content surpasses "maxHeight", a
 * vertical scroll is created. If your content is much shorter than "maxHeight", consider reducing its value for a better animation.
 *
 * @example
 * A simple accordion, styled like a card:
 * ```
 * <Accordion appearance="card" header="This is the title of the accordion" maxHeight={80}>
 *   <p>This is the content of the accordion</p>
 * </Accordion>
 * ```
 *
 * A more complex accordion:
 * ```
 * const header = (toggle: React.ReactElement) => (
 *   <Row justifyContent="space-between" bg="cyan.500" border="cyan.700" radius="sm">
 *     <ImageBox><img src="/my-image.png" /></ImageBox>
 *     <Text>Joseph Clinton</Text>
 *     <Text>40 years old</Text>
 *     {toggle}
 *   </Row>
 * )
 * return (
 *   <Accordion header={header}>
 *     <Center>
 *       <img src="/an-image.png" />
 *       <p>This is the content of the accordion</p>
 *     </Center>
 *   </Accordion>
 * )
 * ```
 */
export const Accordion = withRef(({ id, appearance, expanded, onChange, header, maxHeight = 300, startExpanded, className, style, children, ...props }) => {
    const t = useTranslate(dictionary);
    const initialExpanded = expanded ?? startExpanded ?? false;
    const [ariaHidden, setAriaHidden] = useState(!initialExpanded);
    const accordionId = useMemo(() => id || `${Math.random()}`, [id]);
    useEffect(() => {
        if (expanded !== undefined)
            setAriaHidden(!expanded);
    }, [expanded]);
    const expandBtn = _jsx("input", { type: "checkbox", defaultChecked: initialExpanded, checked: expanded, onChange: () => {
            setAriaHidden(!ariaHidden);
            onChange?.(!expanded);
        }, "aria-label": ariaHidden ? t.open : t.close, title: ariaHidden ? t.open : t.close, onKeyDown: e => e.key === 'Enter' && e.target.click?.(), "aria-controls": accordionId });
    const headerContent = typeof header === 'function' ? header(expandBtn) : _jsxs("label", { children: [header, expandBtn] });
    return (_jsxs(CitricComponent, { tag: "div", component: "accordion", className: listToClass([appearance, className]), style: applyCSSVariable(style, 'max-height', `${maxHeight}px`), ...props, children: [_jsx("header", { children: headerContent }), _jsx("section", { id: accordionId, "aria-hidden": ariaHidden, ...(ariaHidden ? { inert: 'true' } : {}), children: appearance === 'card' ? _jsx("div", { className: "content", children: children }) : children })] }));
});
const dictionary = {
    en: {
        open: 'Open',
        close: 'Close',
    },
    pt: {
        open: 'Abrir',
        close: 'Fechar',
    },
};
//# sourceMappingURL=Accordion.js.map