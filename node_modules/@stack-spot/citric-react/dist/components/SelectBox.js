import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { listToClass } from '@stack-spot/portal-theme';
import { useMemo } from 'react';
import { defaultRenderKey, defaultRenderLabel } from '../utils/options.js';
import { withRef } from '../utils/react.js';
import { CitricComponent } from './CitricComponent.js';
import { layout } from './layout.js';
/**
 * This component does exactly the same thing as "CheckboxGroup" and "RadioGroup", but with different visuals and less customization.
 *
 * Each option is rendered as a selectable card. The user can select a single option (radio buttons) or multiple options (checkboxes),
 * depending on the value of the property "multiple", which is false by default.
 *
 * Use `renderLabel` to determine what to render inside each card. This is not a free react element, it must return an object containing an
 * icon, a title and a description.
 *
 * @example
 *
 * ```
 * const options = useMemo(() => [
 *   { id: 1, image: 'https://images.com/1.png', name: 'Basic plan', price: 59 },
 *   { id: 2, image: 'https://images.com/2.png', name: 'Gold plan', price: 69 },
 *   { id: 3, image: 'https://images.com/3.png', name: 'Safira plan', price: 79' },
 *   { id: 4, image: 'https://images.com/4.png', name: 'Diamond plan', price: 99 },
 * ], [])
 *
 * return <SelectBox
 *   options={options}
 *   renderKey={o => o.id}
 *   renderLabel={o => ({
 *     icon: <img src={o.image} />,
 *     title: o.name,
 *     description: `$${price.toFixed(2)}`,
 *   })}
 * />
 * ```
 */
export const SelectBox = withRef(function SelectBox({ multiple, name, value, options, onChange, renderLabel = o => ({ title: defaultRenderLabel(o) }), renderKey = defaultRenderKey, isDisabled, className, style, direction, bgLevel, colorPalette, colorScheme, appearance, ...props }) {
    const items = useMemo(() => {
        const valueAsArray = value ? (Array.isArray(value) ? value : [value]) : [];
        const valueKeys = valueAsArray.map(renderKey);
        return options.map((o) => {
            const key = renderKey(o);
            const label = renderLabel(o);
            const checked = value ? valueKeys.includes(key) : undefined;
            return (_jsxs(CitricComponent, { tag: "label", component: "select-box", className: listToClass([bgLevel && `bg-${bgLevel}`, appearance]), children: [_jsx("input", { type: multiple ? 'checkbox' : 'radio', name: name, value: key, checked: checked, disabled: isDisabled?.(o), onChange: onChange ? (e) => {
                            if (multiple) {
                                onChange(e.target.checked ? [...valueAsArray, o] : valueAsArray.filter(v => renderKey(v) !== key));
                            }
                            else {
                                onChange(o);
                            }
                        } : undefined }, `${key}-${checked}`), _jsxs("div", { className: "option", children: [label.icon, _jsx("p", { className: "title", children: label.title }), label.description && appearance !== 'button' && _jsx("p", { className: "description", children: label.description })] })] }, key));
        });
    }, [options, value, name, multiple, bgLevel, appearance]);
    return (_jsx("div", { "data-color-palette": colorPalette, "data-color-scheme": colorScheme, className: listToClass([className, direction === 'vertical' ? layout.column : layout.row]), style: { gap: '5px', ...style }, ...props, children: items }));
});
//# sourceMappingURL=SelectBox.js.map