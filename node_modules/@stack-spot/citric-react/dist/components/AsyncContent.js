import { jsx as _jsx } from "react/jsx-runtime";
import { useEffect, useLayoutEffect } from 'react';
import { useCitricController } from '../context/hooks.js';
import { withRef } from '../utils/react.js';
import { ErrorMessage } from './ErrorMessage.js';
import { LoadingPanel } from './LoadingPanel.js';
/**
 * Renders a component that provides user feedback on async requests. It renders either a loading component, an error component or its
 * children.
 *
 * The loading and error views can be customized through a CitricController.
 *
 * Errors can be watched through the function `onError` of a CitricController.
 *
 * Attention: for React Suspense, use the component "FallbackBoundary" instead.
 *
 * @example
 *
 * ```
 * const [data, isLoading, error] = useRemoteData()
 *
 * return (
 *   <AsyncContent loading={isLoading} error={error}>
 *     {data}
 *   </AsyncContent>
 * )
 * ```
 */
export const AsyncContent = withRef(({ loading, error, autofocus, children, loadingStyle }) => {
    const citric = useCitricController();
    useEffect(() => {
        if (error) {
            citric?.onError?.(error);
            // eslint-disable-next-line no-console
            console.error(error);
        }
    }, [error]);
    useLayoutEffect(() => {
        if (!loading && !error) {
            typeof autofocus === 'string' ? document.querySelector(autofocus)?.focus?.() : autofocus?.current?.focus();
        }
    }, [loading, error]);
    if (loading)
        return citric?.renderLoading ? citric.renderLoading(loadingStyle) : _jsx(LoadingPanel, { ...loadingStyle });
    if (error)
        return citric?.renderError ? citric.renderError(error) : _jsx(ErrorMessage, { error: error });
    return children;
});
//# sourceMappingURL=AsyncContent.js.map