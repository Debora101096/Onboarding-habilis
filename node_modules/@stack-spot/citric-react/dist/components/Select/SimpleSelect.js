import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useCallback, useMemo } from 'react';
import { defaultRenderKey, defaultRenderLabel } from '../../utils/options.js';
import { withRef } from '../../utils/react.js';
import { CitricComponent } from '../CitricComponent.js';
import { ProgressCircular } from '../ProgressCircular.js';
export const SimpleSelect = withRef(function SimpleSelect({ ref, options, value, onChange, renderLabel = defaultRenderLabel, renderKey = defaultRenderKey, required = true, loading, disabled, onBlur, onFocus, wrap, ...props }) {
    const handleChange = useCallback((e) => {
        const selectedIndex = e.target.options.selectedIndex - (e.target.options.length > options.length ? 1 : 0);
        onChange?.(selectedIndex >= 0 ? options[selectedIndex] : undefined);
    }, [options]);
    const renderedOptions = useMemo(() => {
        const items = (!value || !required) ? [_jsx("option", { children: renderLabel(undefined) }, "")] : [];
        options.forEach((o) => {
            const key = renderKey(o);
            items.push(_jsx("option", { value: key, children: renderLabel(o) }, key));
        });
        return items;
    }, [options, value, required]);
    return wrap === false ? (_jsx(CitricComponent, { tag: "select", ref: ref, required: required, onChange: handleChange, disabled: disabled || loading, component: "select", onFocus: onFocus, onBlur: onBlur, value: value ? renderKey(value) : '', children: renderedOptions })) : (_jsxs(CitricComponent, { ref: ref, tag: "div", component: "select", "aria-busy": loading, ...props, children: [_jsx("select", { value: value ? renderKey(value) : undefined, required: required, onChange: handleChange, disabled: disabled || loading, onFocus: onFocus, onBlur: onBlur, children: renderedOptions }), loading && _jsx(ProgressCircular, { className: "loader", size: "xs" })] }));
});
//# sourceMappingURL=SimpleSelect.js.map