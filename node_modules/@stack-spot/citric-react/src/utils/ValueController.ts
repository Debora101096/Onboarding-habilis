import { pull } from 'lodash'

export type ValueListener<T> = (value: T) => void

export class ValueController<T> {
  protected value: T
  private listeners: ValueListener<T>[] = []
  
  constructor(value: T) {
    this.value = value
  }

  onChange(listener: ValueListener<T>) {
    this.listeners.push(listener)
    return () => {
      pull(this.listeners, listener)
    }
  }

  setValue(value: T) {
    this.value = value
    this.listeners.forEach(l => l(value))
  }

  getValue() {
    return this.value
  }
}
