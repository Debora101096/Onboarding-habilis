import { ValueController } from '../../utils/ValueController'

export class TabController<Key extends string> extends ValueController<Key> {
  private tabOrder: Key[]

  constructor(tabOrder: Key[], value: Key) {
    super(value)
    this.tabOrder = tabOrder
  }

  private getCurrentIndex() {
    return this.tabOrder.findIndex(t => t === this.value)
  }

  /**
   * @returns true if there's another tab after the one currently selected. False otherwise.
   */
  hasNext(): boolean {
    const current = this.getCurrentIndex()
    return current > -1 && current + 1 < this.tabOrder.length
  }

  /**
   * @returns true if there's a tab before the one currently selected. False otherwise.
   */
  hasPrevious(): boolean {
    const current = this.getCurrentIndex()
    return current > -1 && current - 1 >= 0
  }

  /**
   * Selects the tab on the right of the one currently selected. If there's no next tab, nothing happens.
   * @returns true if the tab is changed, false otherwise.
   */
  next(): boolean {
    if (this.hasNext()) {
      this.setValue(this.tabOrder[this.getCurrentIndex() + 1])
      return true
    }
    return false
  }

  /**
   * Selects the tab on the left of the one currently selected. If there's no previous tab, nothing happens.
   * @returns true if the tab is changed, false otherwise.
   */
  previous(): boolean {
    if (this.hasPrevious()) {
      this.setValue(this.tabOrder[this.getCurrentIndex() - 1])
      return true
    }
    return false
  }
}
